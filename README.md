# excel2flatbuffers-rs
convert excel to flatbuffers table and pack excel data to binary file, for game development.

1. 根据Excel表头生成Flatbuffers的fbs文件(目前支持int,float,long,string)
2. 将Excel中的数据使用flatbuffers的结构，打包成二进制文件
3. 生成目标语言代码

> excel 的结构的解析，可以根据自己的需要去修改解析代码。flatc.exe 是必须的，放到工程根目录。在最终编译出 exe 后，放到和 exe 放一起。

### 使用

`excel2flatbuffers-rs.exe -l csharp -e ./excels/ -b ./generated/bytes/ -c ./generated/code/ -f ./generated/fbs/ `

> 注意路径的后面要加上 `/`

下面是一个批处理文件代码示例，应用于Unity游戏项目中。首先删除临时的生成目录，然后生成目标代码，最后拷贝到Unity的工程中。

```shell
rmdir /s /q ..\TmpAutoGenerated

..\..\Tools\Excel2Flatbuffers\excel2flatbuffers-rs.exe -l csharp -e .\ -b ..\TmpAutoGenerated\bytes\ -c ..\TmpAutoGenerated\code\ -f ..\TmpAutoGenerated\fbs\ 
echo "generated"

rmdir /s /q ..\..\Assets\Scripts\AutoGenerated\ConfigTables
mkdir ..\..\Assets\Scripts\AutoGenerated\ConfigTables
xcopy ..\TmpAutoGenerated\code\*.cs ..\..\Assets\Scripts\AutoGenerated\ConfigTables\

rmdir /s /q ..\..\Assets\Res\ConfigBytes
mkdir ..\..\Assets\Res\ConfigBytes
xcopy ..\TmpAutoGenerated\bytes\*.bytes ..\..\Assets\Res\ConfigBytes\

pause
```



#### Rust 真的好快！哈哈哈哈